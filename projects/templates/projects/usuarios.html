{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block page_title %} Usuários {% endblock page_title %}
{% block title %} Usuários {% endblock title %}
{% block content %}
		
	{% if altera %}
		
		<form method="POST" >{% csrf_token %}
			
			{% crispy form %}
			
			{% if erro %}
				<div class="form-group">
					<p class="text danger">{{ erro }}</p>
				</div>
			{% endif %}

		</form>

	{% else %}
		
		{% if user.usefilter %}	
			<div class="filtro col mb-4 fs-6 mx-5">
				<form method="GET">
					<label>Nome: </label>
					{{ filter.form.name }}
					
					<label>Email: </label>
					{{ filter.form.email }}
					
					<input class="filter_buttons" type="submit" value="Filtrar" />
					<input class="filter_buttons" type="button" value="Limpar" onclick="limparCampos()" />
				</form>
			</div>
		{% endif %}
		
		<table class="table table-hover">
			<thead>
				<tr>
					<th>ID</th>
					<th>Name</th>
					<th>E-mail</th>
					<th>Ativo</th>
					<th>Tipo</th>
					<th>Perfil</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				
				{% for user in filter.qs %}
				<tr>
					<td>{{ user.user_id }}</td>
					<td>{{ user.name }}</td>
					<td>{{ user.email }}</td>
					<td>{{ user.active }}</td>
					<td>{{ user.get_tipo_display }}</td>
					<td>{{ user.get_perfil_display }}</td>
					<td>
						<a href="{% url "usuarios" opc='edit' pk=user.email %}" class="btn btn-sm btn-secondary">Editar</a>
						<a href="{% url "usuarios" opc='delete' pk=user.email %}" class="btn btn-sm btn-danger">Excluir</a>
					</td>
				</tr>
				{% endfor %}
				
			</tbody>
		</table>
		<a href="{% url 'cadastrar_usuario' %}" class="btn btn-primary mt-4">Cadastrar Usuário</a>
	{% endif %}

<script>
	function limparCampos(){
		document.getElementById('id_name').value='';
		document.getElementById('id_email').value='';
	}
</script>

{% endblock content %}